<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="js/angular.min.js"></script>
    <script src="js/app.js"></script>
    <title>Статистика заказов в Перекрёсток</title>
</head>
<body ng-app="PerekrestorOrderStats">


<div class="container" ng-controller="MainController as Ctrl">
    <div class="row">
        <div class="col-3 text-center offset-1">
            Начало
        </div>
        <div class="col-3 text-center">
            Конец
        </div>
    </div>
    <div class="row form-group">
        <div class="col-3 offset-1">
            <input type="date" class="form-control" ng-model="Ctrl.startDate">
        </div>
        <div class="col-3">
            <input type="date" class="form-control" ng-model="Ctrl.endDate">
        </div>
        <div class="col-3">
            <button class="btn btn-primary w-100" ng-click="Ctrl.launch();">Запуск!</button>
        </div>
    </div>
    <div class="row" ng-show="Ctrl.showFilters">
        <div class="col-3 offset-1">
            <button class="btn btn-secondary w-100" ng-click="Ctrl.sortByPrice();">по цене</button>
        </div>
        <div class="col-3">
            <button class="btn btn-secondary w-100" ng-click="Ctrl.sortByCost();">по стоимости</button>
        </div>
        <div class="col-3">
            <button class="btn btn-secondary w-100" ng-click="Ctrl.sortByAmount();">по количеству</button>
        </div>
    </div>
    <div ng-show="Ctrl.showDetails">
        <div ng-hide="1">
        <div class="row"><div class="col-12 text-center font-weight-bold">Чаще всего вы покупали это</div></div>
        <div class="row">
            <div class="col-3"><img ng-src="{{Ctrl.topAmountProduct.img}}"></div>
            <div class="col-3">{{Ctrl.topAmountProduct.title}}</div>
            <div class="col-2">{{Ctrl.topAmountProduct.totalAmount}} {{Ctrl.topAmountProduct.amount_unit}}</div>
            <div class="col-2">{{Ctrl.topAmountProduct.avgPrice}} руб</div>
            <div class="col-2">{{Ctrl.topAmountProduct.totalCost}} руб</div>
        </div>
        <div class="row"><div class="col-12 text-center font-weight-bold">Больше всего денег вы потратили на это</div></div>
        <div class="row">
            <div class="col-3"><img ng-src="{{Ctrl.topCostProduct.img}}"></div>
            <div class="col-3">{{Ctrl.topCostProduct.title}}</div>
            <div class="col-2">{{Ctrl.topCostProduct.totalAmount}} {{Ctrl.topCostProduct.amount_unit}}</div>
            <div class="col-2">{{Ctrl.topCostProduct.avgPrice}} руб</div>
            <div class="col-2">{{Ctrl.topCostProduct.totalCost}} руб</div>
        </div>
        </div>
        <br>
        <table class="table table-striped table-bordered" style="width:100%">
            <thead>
            <tr>
                <th></th>
                <th>Название</th>
                <th>Категория</th>
                <th>Общее количество</th>
                <th>Средняя цена</th>
                <th>Всего потрачено</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="product in Ctrl.sortedData">
                <td><img ng-src="{{product.img}}"></td>
                <td>{{product.title}}</td>
                <td>{{product.category}}</td>
                <td ng-if="product.amount_unit == 'шт'">{{product.totalAmount}} {{product.amount_unit}}</td>
                <td ng-if="product.amount_unit == 'кг'">{{product.totalAmount.toFixed(1)}} {{product.amount_unit}}</td>
                <td>{{product.avgPrice.toFixed(2)}} руб</td>
                <td>{{product.totalCost.toFixed(2)}} руб</td>
            </tr>
            </tbody>
        </table>
        <hr>
    </div>

</div>

</body>
</html>